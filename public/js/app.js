angular.module("idea",["ideaController","ideaService","loginService"]);var app=angular.module("ideaController",["ui.router"]).controller("mainController",["$scope","$http","Ideas","$state","Authenticate","LoginService","$timeout",function(t,e,n,o,i,a,r){t.formData={},t.loading=!0,n.get().success(function(e){t.ideas=e,t.loading=!1}),t.createIdea=function(){void 0!=t.formData.text&&(t.loading=!0,n.create(t.formData).success(function(e){t.loading=!1,t.formData={},t.ideas=e}))},t.deleteIdea=function(e){t.loading=!0,n.delete(e).success(function(e){t.loading=!1,t.ideas=e})}}]).directive("ngConfirmClick",[function(){return{link:function(t,e,n){var o=n.ngConfirmClick||"Are you sure?",i=n.confirmedClick;e.bind("click",function(e){window.confirm(o)&&t.$eval(i)})}}}]).run(["$rootScope","$location","$state","LoginService",function(t,e,n,o){o.isAuthenticated()||n.transitionTo("login")}]).config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/login"),t.state("login",{url:"/login",templateUrl:"loginTemplate.html",controller:"LoginController"}).state("home",{url:"/",templateUrl:"domainList.html",controller:"mainController"})}]).controller("LoginController",["$scope","$rootScope","$stateParams","$state","LoginService","$timeout",function(t,e,n,o,i,a){t.formSubmit=function(){i.login(t),t.loading=!0,a(function(){t.loading=!1,i.isAuthenticated()?(t.error="",t.username="",t.password="",o.go("home")):t.error="Incorrect username/password!"},1e3)}}]).factory("LoginService",["Authenticate","$state",function(t,e){var n=!1;return{login:function(e){t.authenticate(e.loginData).then(function(t){return value=t.data.callback===!1?t.data.callback:'"'+t.data.callback+'"',localStorage.setItem("token",'{"token":'+value+"}"),n})},isAuthenticated:function(){return localStorage.getItem("token")?(auth=JSON.parse(localStorage.getItem("token")).token||!1,auth?auth:(e.go("login"),!1)):(e.go("login"),!1)}}}]);angular.module("ideaService",[]).factory("Ideas",["$http","LoginService",function(t,e){return{get:function(){return e.isAuthenticated(),t.get("/api/ideas")},create:function(n){return e.isAuthenticated(),t.post("/api/ideas",n)},delete:function(n,o){return e.isAuthenticated(),t.delete("/api/ideas/"+n)}}}]),angular.module("loginService",[]).factory("Authenticate",["$http",function(t){return{authenticate:function(e){return a=t.post("/api/authenticate",e),a}}}]);